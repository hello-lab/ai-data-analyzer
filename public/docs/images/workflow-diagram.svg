<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="1000" viewBox="0 0 900 1000">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; }
      .step-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; rx: 8; }
      .decision { fill: #f39c12; stroke: #d68910; stroke-width: 2; }
      .process { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; rx: 8; }
      .output { fill: #27ae60; stroke: #229954; stroke-width: 2; rx: 8; }
      .text { font-family: Arial, sans-serif; font-size: 11px; fill: white; text-anchor: middle; }
      .step-num { font-family: Arial, sans-serif; font-size: 10px; fill: #2c3e50; font-weight: bold; }
      .arrow { fill: none; stroke: #7f8c8d; stroke-width: 2; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#7f8c8d" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" class="title">AI Data Processing Workflow</text>
  
  <!-- Step 1: Data Loading -->
  <text x="50" y="70" class="step-num">1.</text>
  <rect x="70" y="55" width="200" height="50" class="step-box"/>
  <text x="170" y="75" class="text">Load CSV Data</text>
  <text x="170" y="90" class="text">Read users.csv with csv-parser</text>
  
  <!-- Step 2: Data Validation -->
  <text x="50" y="140" class="step-num">2.</text>
  <polygon points="170,125 220,145 170,165 120,145" class="decision"/>
  <text x="170" y="150" class="text" style="font-size: 10px;">Valid Data?</text>
  
  <!-- Step 3: Preprocessing -->
  <text x="50" y="210" class="step-num">3.</text>
  <rect x="70" y="195" width="200" height="50" class="process"/>
  <text x="170" y="215" class="text">Data Preprocessing</text>
  <text x="170" y="230" class="text">Convert types, handle nulls</text>
  
  <!-- Step 4: Feature Engineering -->
  <text x="50" y="280" class="step-num">4.</text>
  <rect x="70" y="265" width="200" height="50" class="process"/>
  <text x="170" y="285" class="text">Create Feature Vectors</text>
  <text x="170" y="300" class="text">[stepcount, pushup, squat, balance]</text>
  
  <!-- Step 5: K-Means Clustering -->
  <text x="50" y="350" class="step-num">5.</text>
  <rect x="70" y="335" width="200" height="50" class="process"/>
  <text x="170" y="355" class="text">K-Means Clustering (k=4)</text>
  <text x="170" y="370" class="text">Segment users into groups</text>
  
  <!-- Step 6: Engagement Calculation -->
  <text x="350" y="350" class="step-num">6.</text>
  <rect x="370" y="335" width="200" height="50" class="process"/>
  <text x="470" y="355" class="text">Calculate Engagement Index</text>
  <text x="470" y="370" class="text">Weighted sum of activities</text>
  
  <!-- Step 7: Consistency Score -->
  <text x="650" y="350" class="step-num">7.</text>
  <rect x="670" y="335" width="200" height="50" class="process"/>
  <text x="770" y="355" class="text">Activity Consistency Score</text>
  <text x="770" y="370" class="text">1 / (1 + standard deviation)</text>
  
  <!-- Step 8: Statistical Analysis -->
  <text x="50" y="450" class="step-num">8.</text>
  <rect x="70" y="435" width="200" height="50" class="process"/>
  <text x="170" y="455" class="text">Statistical Analysis</text>
  <text x="170" y="470" class="text">Mean, median, std dev</text>
  
  <!-- Step 9: Outlier Detection -->
  <text x="350" y="450" class="step-num">9.</text>
  <rect x="370" y="435" width="200" height="50" class="process"/>
  <text x="470" y="455" class="text">Outlier Detection</text>
  <text x="470" y="470" class="text">Z-score > 3 threshold</text>
  
  <!-- Step 10: Correlation Analysis -->
  <text x="650" y="450" class="step-num">10.</text>
  <rect x="670" y="435" width="200" height="50" class="process"/>
  <text x="770" y="455" class="text">Correlation Analysis</text>
  <text x="770" y="470" class="text">Balance vs Steps relationship</text>
  
  <!-- Step 11: Similarity Matching -->
  <text x="50" y="550" class="step-num">11.</text>
  <rect x="70" y="535" width="200" height="50" class="process"/>
  <text x="170" y="555" class="text">Find Similar Users</text>
  <text x="170" y="570" class="text">Euclidean distance matching</text>
  
  <!-- Step 12: Team Analytics -->
  <text x="350" y="550" class="step-num">12.</text>
  <rect x="370" y="535" width="200" height="50" class="process"/>
  <text x="470" y="555" class="text">Team-Level Analytics</text>
  <text x="470" y="570" class="text">Group performance metrics</text>
  
  <!-- Step 13: Personalized Recommendations -->
  <text x="650" y="550" class="step-num">13.</text>
  <rect x="670" y="535" width="200" height="50" class="process"/>
  <text x="770" y="555" class="text">Generate Recommendations</text>
  <text x="770" y="570" class="text">Challenge targets &amp; deadlines</text>
  
  <!-- Step 14: Data Aggregation -->
  <text x="200" y="650" class="step-num">14.</text>
  <rect x="220" y="635" width="200" height="50" class="process"/>
  <text x="320" y="655" class="text">Aggregate Results</text>
  <text x="320" y="670" class="text">Prepare API response</text>
  
  <!-- Step 15: Top Performers -->
  <text x="500" y="650" class="step-num">15.</text>
  <rect x="520" y="635" width="200" height="50" class="process"/>
  <text x="620" y="655" class="text">Rank Top Performers</text>
  <text x="620" y="670" class="text">Sort by engagement &amp; consistency</text>
  
  <!-- Final Outputs -->
  <text x="50" y="750" class="step-num">Output:</text>
  <rect x="100" y="735" width="150" height="50" class="output"/>
  <text x="175" y="755" class="text">User Profiles</text>
  <text x="175" y="770" class="text">&amp; Segments</text>
  
  <rect x="300" y="735" width="150" height="50" class="output"/>
  <text x="375" y="755" class="text">Team Statistics</text>
  <text x="375" y="770" class="text">&amp; Rankings</text>
  
  <rect x="500" y="735" width="150" height="50" class="output"/>
  <text x="575" y="755" class="text">Performance</text>
  <text x="575" y="770" class="text">Insights</text>
  
  <rect x="700" y="735" width="150" height="50" class="output"/>
  <text x="775" y="755" class="text">Dashboard</text>
  <text x="775" y="770" class="text">Visualizations</text>
  
  <!-- API Response Structure -->
  <rect x="200" y="820" width="500" height="120" style="fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 1; rx: 8;"/>
  <text x="450" y="840" style="font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">JSON API Response Structure</text>
  <text x="220" y="860" style="font-family: 'Courier New', monospace; font-size: 10px; fill: #2c3e50;">{</text>
  <text x="230" y="875" style="font-family: 'Courier New', monospace; font-size: 10px; fill: #2c3e50;">  "summary": { totalUsers, totalTeams, correlationBalanceStep, clusters },</text>
  <text x="230" y="890" style="font-family: 'Courier New', monospace; font-size: 10px; fill: #2c3e50;">  "users": [ { cluster, engagement_index, activity_consistency, ... } ],</text>
  <text x="230" y="905" style="font-family: 'Courier New', monospace; font-size: 10px; fill: #2c3e50;">  "teamStats": [ { team, avgStep, avgPushup, engagement, members } ],</text>
  <text x="230" y="920" style="font-family: 'Courier New', monospace; font-size: 10px; fill: #2c3e50;">  "topPerformers": { engagement: [...], consistency: [...], outliers: [...] }</text>
  <text x="220" y="935" style="font-family: 'Courier New', monospace; font-size: 10px; fill: #2c3e50;">}</text>
  
  <!-- Arrows showing workflow -->
  <line x1="170" y1="105" x2="170" y2="125" class="arrow"/>
  <line x1="170" y1="165" x2="170" y2="195" class="arrow"/>
  <line x1="170" y1="245" x2="170" y2="265" class="arrow"/>
  <line x1="170" y1="315" x2="170" y2="335" class="arrow"/>
  
  <!-- Branch to parallel processing -->
  <line x1="270" y1="360" x2="360" y2="360" class="arrow"/>
  <line x1="570" y1="360" x2="660" y2="360" class="arrow"/>
  
  <!-- Convergence to next steps -->
  <line x1="170" y1="385" x2="170" y2="435" class="arrow"/>
  <line x1="470" y1="385" x2="470" y2="435" class="arrow"/>
  <line x1="770" y1="385" x2="770" y2="435" class="arrow"/>
  
  <!-- Next level processing -->
  <line x1="170" y1="485" x2="170" y2="535" class="arrow"/>
  <line x1="470" y1="485" x2="470" y2="535" class="arrow"/>
  <line x1="770" y1="485" x2="770" y2="535" class="arrow"/>
  
  <!-- Convergence to aggregation -->
  <line x1="170" y1="585" x2="270" y2="635" class="arrow"/>
  <line x1="470" y1="585" x2="390" y2="635" class="arrow"/>
  <line x1="770" y1="585" x2="670" y2="635" class="arrow"/>
  
  <!-- Final outputs -->
  <line x1="320" y1="685" x2="175" y2="735" class="arrow"/>
  <line x1="320" y1="685" x2="375" y2="735" class="arrow"/>
  <line x1="620" y1="685" x2="575" y2="735" class="arrow"/>
  <line x1="620" y1="685" x2="775" y2="735" class="arrow"/>
</svg>